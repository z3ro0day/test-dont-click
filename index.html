<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snap & Upload</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #1f1c2c, #928dab);
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    min-height: 100vh;
    padding: 20px;
  }

  h1 {
    margin-bottom: 20px;
    font-size: 2rem;
    text-shadow: 1px 1px 4px #000;
  }

  video, canvas {
    border: 3px solid #fff;
    border-radius: 15px;
    margin-bottom: 15px;
    max-width: 100%;
  }

  .buttons {
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
  }

  button {
    padding: 12px 25px;
    border: none;
    border-radius: 12px;
    font-size: 16px;
    cursor: pointer;
    font-weight: bold;
    transition: all 0.2s ease-in-out;
  }

  #snap {
    background: #ff4b2b;
    color: #fff;
  }

  #snap:hover {
    background: #ff3a1a;
  }

  #upload {
    background: #1c92d2;
    color: #fff;
  }

  #upload:hover {
    background: #0c6aa0;
  }

  #status {
    margin-top: 10px;
    font-weight: bold;
  }
</style>
</head>
<body>

<h1>Snap & Upload</h1>

<video id="video" width="320" height="240" autoplay></video>
<canvas id="canvas" width="320" height="240" style="display:none;"></canvas>

<div class="buttons">
  <button id="snap">Take Photo</button>
  <button id="upload">Upload Photo</button>
</div>

<div id="status"></div>

<script>
const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const snap = document.getElementById('snap');
const uploadBtn = document.getElementById('upload');
const status = document.getElementById('status');

let lastPhotoData = null;

// Choose upload target: "discord" or "dropbox"
const UPLOAD_TARGET = "discord"; // change to "dropbox" if desired

// --- Discord settings ---
const DISCORD_WEBHOOK_URL = "https://discord.com/api/webhooks/1435469588602290278/9bOU6n5m03UX5fBTAhEwHrYVBKxPQBzyRRc1cL0Q8HjtquhCVqKEZLZXy_CCpr_NyG4K";

// --- Dropbox settings ---
const DROPBOX_ACCESS_TOKEN = "YOUR_DROPBOX_ACCESS_TOKEN";
const DROPBOX_PATH = "/snapshots/photo.png"; // path in Dropbox

// Access webcam
navigator.mediaDevices.getUserMedia({ video: true })
  .then(stream => { video.srcObject = stream; })
  .catch(err => {
    status.innerText = "Error accessing webcam: " + err;
    console.error(err);
  });

// Take photo
snap.addEventListener('click', () => {
  const context = canvas.getContext('2d');
  context.drawImage(video, 0, 0, canvas.width, canvas.height);
  lastPhotoData = canvas.toDataURL('image/png');
  canvas.style.display = 'block';
  status.innerText = "Photo ready! Click 'Upload Photo'.";
});

// Upload photo
uploadBtn.addEventListener('click', () => {
  if(!lastPhotoData) {
    status.innerText = "Take a photo first!";
    return;
  }

  status.innerText = "Uploading photo...";

  if(UPLOAD_TARGET === "discord") {
    // Discord webhook
    fetch(DISCORD_WEBHOOK_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ content: "New photo!", embeds: [{ image: { url: lastPhotoData } }] })
    })
    .then(res => {
      if(res.ok) status.innerText = "Photo uploaded to Discord!";
      else status.innerText = "Failed to upload to Discord.";
    })
    .catch(err => { status.innerText = "Error: " + err; console.error(err); });

  } else if(UPLOAD_TARGET === "dropbox") {
    // Dropbox upload
    const blob = dataURLtoBlob(lastPhotoData);
    fetch('https://content.dropboxapi.com/2/files/upload', {
      method: 'POST',
      headers: {
        'Authorization': 'Bearer ' + DROPBOX_ACCESS_TOKEN,
        'Content-Type': 'application/octet-stream',
        'Dropbox-API-Arg': JSON.stringify({ path: DROPBOX_PATH, mode: 'overwrite', autorename: true })
      },
      body: blob
    })
    .then(res => {
      if(res.ok) status.innerText = "Photo uploaded to Dropbox!";
      else status.innerText = "Failed to upload to Dropbox.";
    })
    .catch(err => { status.innerText = "Error: " + err; console.error(err); });
  }
});

// Helper: convert dataURL to Blob for Dropbox
function dataURLtoBlob(dataurl) {
  let arr = dataurl.split(','), mime = arr[0].match(/:(.*?);/)[1],
      bstr = atob(arr[1]), n = bstr.length, u8arr = new Uint8Array(n);
  while(n--) u8arr[n] = bstr.charCodeAt(n);
  return new Blob([u8arr], {type:mime});
}
</script>

</body>
</html>
